{
  "metadata": {
    "project_name": "Substrate Phase 7: UX Refinement and Delivery",
    "approved_by": "david-fraser",
    "approved_at": "2026-02-27",
    "planning_source": "from_json",
    "planning_generated_at": "2026-02-27T16:00:00.000000",
    "phase": "7"
  },
  "work_areas": [
    {
      "id": "71-0",
      "title": "UX Foundation",
      "description": "Establish the new root UI structure and validate the Next.js delivery path."
    },
    {
      "id": "72-0",
      "title": "Governance Integration",
      "description": "Integrate the governance CLI and state reporting into the new Next.js UI."
    },
    {
      "id": "73-0",
      "title": "Repo Simplification",
      "description": "Remove template marketplace/substrate bloat and restore a lightweight control plane + app placeholder baseline."
    },
    {
      "id": "74-0",
      "title": "Shipping Hygiene",
      "description": "Enforce source-only shipping so installable/generated artifacts are never included in clone-and-own releases."
    },
    {
      "id": "75-0",
      "title": "Governance Enhancements Program",
      "description": "Implement PRD-SUB-2026-002 lifecycle + semantic governance enhancements with deterministic controls and full governance-doc synchronization."
    },
    {
      "id": "76-0",
      "title": "Governance Hardening Gaps",
      "description": "Address post-review minor gaps: test coverage, ontology depth/clarity, drift-check semantics, documented defaults, and Gemini lifecycle parity."
    },
    {
      "id": "77-0",
      "title": "PRD v2 DCL + Multi-User Implementation",
      "description": "Implement PRD-SUB-2026-002 v2 delta with corrected scope/claims: DCL foundation, compatibility clarifications, canonicalization conformance, file-mode transactional safety, drift maturity separation, and RBAC-first multi-user architecture."
    }
  ],
  "packets": [
    {
      "id": "UX-701",
      "wbs_ref": "71.1",
      "area_id": "71-0",
      "title": "Establish Root UI Structure",
      "scope": "Move active UX to root /ui directory, update package.json, and verify development server startup. Output: Functional Next.js app in /ui."
    },
    {
      "id": "UX-702",
      "wbs_ref": "71.2",
      "area_id": "71-0",
      "title": "Validate Delivery Path",
      "scope": "Verify build, lint, and typecheck commands for the new UI structure. Output: Successful 'npm run build' in /ui."
    },
    {
      "id": "RF-731",
      "wbs_ref": "3.1",
      "area_id": "73-0",
      "title": "Baseline and scope freeze",
      "scope": "Capture current control-plane behavior, route map, and dependency usage before refactor. Output: written baseline notes and file inventory for safe deletion boundaries."
    },
    {
      "id": "RF-732",
      "wbs_ref": "3.2",
      "area_id": "73-0",
      "title": "Remove marketplace surface",
      "scope": "Delete ui/app/marketplace routes and layout, remove marketplace navigation entry points, and ensure no control-plane path references marketplace routes."
    },
    {
      "id": "RF-733",
      "wbs_ref": "3.3",
      "area_id": "73-0",
      "title": "Reduce app UX to placeholder",
      "scope": "Keep only the App placeholder experience and required shell layout; remove starter app pages not required for control-plane operation."
    },
    {
      "id": "RF-734",
      "wbs_ref": "3.4",
      "area_id": "73-0",
      "title": "Converge to single WBS JSON",
      "scope": "Retain .governance/wbs.json as canonical definition and remove/archive extra tracked WBS variants, updating docs/scripts to reflect single-definition policy."
    },
    {
      "id": "RF-735",
      "wbs_ref": "3.5",
      "area_id": "73-0",
      "title": "Remove substrate duplication artifacts",
      "scope": "Eliminate generated substrate/dist recursive snapshot outputs from workspace and add guardrails (.gitignore/docs/script) to prevent reintroduction."
    },
    {
      "id": "RF-736",
      "wbs_ref": "3.6",
      "area_id": "73-0",
      "title": "Prune UI dependencies and validate",
      "scope": "Remove unused UI dependencies introduced by marketplace/template code and validate lint/typecheck/build plus governance validation commands."
    },
    {
      "id": "SHIP-741",
      "wbs_ref": "4.1",
      "area_id": "74-0",
      "title": "Define source-only shipping contract",
      "scope": "Document a canonical shipping policy: ship from git source only, never from working directory snapshots, and explicitly list allowed vs forbidden artifacts for clone-and-own release bundles."
    },
    {
      "id": "SHIP-742",
      "wbs_ref": "4.2",
      "area_id": "74-0",
      "title": "Implement shipping gate script",
      "scope": "Create scripts/shipping-check.sh to fail when forbidden artifacts are present or tracked (node_modules, .next, dist, substrate snapshots, other generated payloads) and emit actionable remediation steps."
    },
    {
      "id": "SHIP-743",
      "wbs_ref": "4.3",
      "area_id": "74-0",
      "title": "Wire shipping checks into CI",
      "scope": "Add CI workflow step(s) that run shipping-check and block merges/releases on violation; ensure failure output is concise and policy-aligned."
    },
    {
      "id": "SHIP-744",
      "wbs_ref": "4.4",
      "area_id": "74-0",
      "title": "Add release-safe cleanup tooling",
      "scope": "Provide an explicit pre-release cleanup command/script that removes local generated/install artifacts without touching tracked source, and document safe usage."
    },
    {
      "id": "SHIP-745",
      "wbs_ref": "4.5",
      "area_id": "74-0",
      "title": "Add release packaging path",
      "scope": "Define and document release packaging via git archive (or equivalent source-only packaging path) to guarantee untracked artifacts are excluded from shipped bundles."
    },
    {
      "id": "SHIP-746",
      "wbs_ref": "4.6",
      "area_id": "74-0",
      "title": "Validate shipping hygiene end-to-end",
      "scope": "Run shipping checks plus build/lint/typecheck on a clean workspace and produce evidence showing release bundles exclude installable/generated libraries while retaining reproducible setup via lockfiles."
    },
    {
      "id": "GOV-751",
      "wbs_ref": "5.1",
      "area_id": "75-0",
      "title": "PRD hardening and execution contract",
      "scope": "Convert PRD-SUB-2026-002 draft into implementation-ready contract decisions (identity model, deterministic gating boundaries, migration/version policy, authority model) and publish as governed design doc."
    },
    {
      "id": "GOV-752",
      "wbs_ref": "5.2",
      "area_id": "75-0",
      "title": "State machine and log schema extension design",
      "scope": "Define canonical enum/state transitions for PREFLIGHT, STALLED, REVIEW, ESCALATED plus structured event schema/versioning for preflight, heartbeat, review, ontology, and template events."
    },
    {
      "id": "GOV-753",
      "wbs_ref": "5.3",
      "area_id": "75-0",
      "title": "Governance document baseline update",
      "scope": "Update constitution, AGENTS.md, README, and governance workflow docs to describe new lifecycle states, role boundaries, and migration posture before feature implementation begins."
    },
    {
      "id": "GOV-754",
      "wbs_ref": "5.4",
      "area_id": "75-0",
      "title": "Pre-flight engine transitions",
      "scope": "Implement PREFLIGHT state handling with packet/global preflight_required controls, transition guards, timeout fallback to pending, and append-only event logging."
    },
    {
      "id": "GOV-755",
      "wbs_ref": "5.5",
      "area_id": "75-0",
      "title": "Pre-flight CLI and API surface",
      "scope": "Add preflight, preflight-approve, preflight-return command/API paths with validation of readiness assessment structure and supervisor decision recording."
    },
    {
      "id": "GOV-756",
      "wbs_ref": "5.6",
      "area_id": "75-0",
      "title": "Pre-flight dashboard integration",
      "scope": "Add preflight status visibility, assessment viewer, and approval/return controls in control-plane UI without breaking existing packet views."
    },
    {
      "id": "GOV-757",
      "wbs_ref": "5.7",
      "area_id": "75-0",
      "title": "Heartbeat telemetry ingestion",
      "scope": "Add heartbeat command/API ingestion and structured event persistence fields (status, decisions, obstacles, estimate) with packet-level heartbeat_required controls."
    },
    {
      "id": "GOV-758",
      "wbs_ref": "5.8",
      "area_id": "75-0",
      "title": "Stall detection and STALLED transitions",
      "scope": "Implement heartbeat interval policy, auto-transition to STALLED on missed threshold, resume/reassignment semantics, and supervisor alert hooks."
    },
    {
      "id": "GOV-759",
      "wbs_ref": "5.9",
      "area_id": "75-0",
      "title": "Telemetry dashboard stream",
      "scope": "Add packet heartbeat timeline, age indicators, and stalled-state highlighting to control-plane UX with filterable packet-level history."
    },
    {
      "id": "GOV-760",
      "wbs_ref": "5.10",
      "area_id": "75-0",
      "title": "Context manifest and attestation core",
      "scope": "Implement context_manifest and project context_policy parsing/validation plus claim-time required-file attestation enforcement and warning-level optional-file handling."
    },
    {
      "id": "GOV-761",
      "wbs_ref": "5.11",
      "area_id": "75-0",
      "title": "Context attestation UX and reporting",
      "scope": "Expose context attestation evidence and policy violations in packet viewer/status outputs and API payloads for supervisor review."
    },
    {
      "id": "GOV-762",
      "wbs_ref": "5.12",
      "area_id": "75-0",
      "title": "Phase A test and migration suite",
      "scope": "Deliver regression and migration tests covering preflight, heartbeat/stall, and context governance with backward compatibility for legacy packets lacking new fields."
    },
    {
      "id": "GOV-763",
      "wbs_ref": "5.13",
      "area_id": "75-0",
      "title": "Review state and two-person integrity core",
      "scope": "Implement REVIEW and ESCALATED transitions, review cycle policy, and hard rejection of same-identity executor/reviewer assignments."
    },
    {
      "id": "GOV-764",
      "wbs_ref": "5.14",
      "area_id": "75-0",
      "title": "Review CLI/API and assessment model",
      "scope": "Add review-claim, review-submit, review-escalate command/API paths and required structured review assessment validation."
    },
    {
      "id": "GOV-765",
      "wbs_ref": "5.15",
      "area_id": "75-0",
      "title": "Review dashboard and verdict history",
      "scope": "Add review queue, reviewer identity visibility, verdict history, and reject/resubmit cycle indicators in control-plane UI."
    },
    {
      "id": "GOV-766",
      "wbs_ref": "5.16",
      "area_id": "75-0",
      "title": "Golden template promotion core",
      "scope": "Implement promote/templates storage model under .governance/templates with versioning, deprecation metadata, and sanitized capture rules."
    },
    {
      "id": "GOV-767",
      "wbs_ref": "5.17",
      "area_id": "75-0",
      "title": "Template reference validation and analytics",
      "scope": "Implement template_ref packet checks, non-blocking conformance warnings, and usage/outcome statistics reporting for dashboard/API."
    },
    {
      "id": "GOV-768",
      "wbs_ref": "5.18",
      "area_id": "75-0",
      "title": "Phase B test and migration suite",
      "scope": "Deliver regression tests for review integrity and template lifecycle plus migration compatibility for repositories without template metadata."
    },
    {
      "id": "GOV-769",
      "wbs_ref": "5.19",
      "area_id": "75-0",
      "title": "Ontology artifact model bootstrap",
      "scope": "Introduce ontology.md and ontology.json contract loaders, schema validation, version tracking, and project-level enablement switches."
    },
    {
      "id": "GOV-770",
      "wbs_ref": "5.20",
      "area_id": "75-0",
      "title": "Deterministic ontology validation on completion",
      "scope": "Implement entity/relationship/invariant deterministic checks on done/review submission paths with configurable warning/error severity handling."
    },
    {
      "id": "GOV-771",
      "wbs_ref": "5.21",
      "area_id": "75-0",
      "title": "Ontology mutation governance workflow",
      "scope": "Implement ontology-propose/approve/reject/history flow with append-only provenance and prohibition of unmanaged ontology mutation paths."
    },
    {
      "id": "GOV-772",
      "wbs_ref": "5.22",
      "area_id": "75-0",
      "title": "Ontology drift detection and health metrics",
      "scope": "Add cross-packet drift heuristics (advisory mode), dashboard ontology health indicators, and supervisor escalation hooks for persistent unresolved drift."
    },
    {
      "id": "GOV-773",
      "wbs_ref": "5.23",
      "area_id": "75-0",
      "title": "Phase C test and migration suite",
      "scope": "Deliver ontology governance regression tests (validation, mutation, drift signals) and backward-compatible migration behavior when ontology governance is disabled."
    },
    {
      "id": "GOV-774",
      "wbs_ref": "5.24",
      "area_id": "75-0",
      "title": "Comprehensive governance doc synchronization",
      "scope": "Synchronize constitution, AGENTS.md, README, governance workflow docs, packet standards, and ontology guidance so runtime behavior and documentation are aligned post-implementation."
    },
    {
      "id": "GOV-775",
      "wbs_ref": "5.25",
      "area_id": "75-0",
      "title": "Program integration, rollout, and closeout report",
      "scope": "Run end-to-end integration validation across phases, capture residual risks and rollout notes, and publish final delivery report with evidence references for all PRD enhancements."
    },
    {
      "id": "GOV-776",
      "wbs_ref": "6.1",
      "area_id": "76-0",
      "title": "Test harness bootstrap",
      "scope": "Create a tests/ baseline for governance engine and CLI pathways so CI discovery has concrete coverage entrypoints. Output: tests/ directory, test package scaffolding, and smoke tests wired for python3 -m unittest discover -s tests -v."
    },
    {
      "id": "GOV-777",
      "wbs_ref": "6.2",
      "area_id": "76-0",
      "title": "Lifecycle transition unit tests",
      "scope": "Add focused unit tests for preflight approve/return, heartbeat stall/resume, and review approve/reject/escalate with two-person integrity enforcement and max-cycle auto-escalation."
    },
    {
      "id": "GOV-778",
      "wbs_ref": "6.3",
      "area_id": "76-0",
      "title": "Ontology validation depth upgrade",
      "scope": "Replace substring-only ontology checks with deterministic token/field-aware checks for anti-aliases, anti-conflations, relationship constraints, and invariant evaluation hooks; keep deterministic behavior and backward compatibility."
    },
    {
      "id": "GOV-779",
      "wbs_ref": "6.4",
      "area_id": "76-0",
      "title": "Ontology and drift semantics documentation",
      "scope": "Document current and upgraded ontology enforcement depth explicitly in README/governance docs, and align drift-check naming/description with actual implemented behavior to avoid overclaiming semantics."
    },
    {
      "id": "GOV-780",
      "wbs_ref": "6.5",
      "area_id": "76-0",
      "title": "Domain ontology reference template",
      "scope": "Provide a domain-focused ontology example/template (program/project/work_package/milestone/deliverable/risk/approval) for regulated infrastructure use cases, with mapping guidance from the core governance ontology."
    },
    {
      "id": "GOV-781",
      "wbs_ref": "6.6",
      "area_id": "76-0",
      "title": "Heartbeat policy defaults surfaced",
      "scope": "Surface and document heartbeat interval/stall-threshold defaults in constitution and README plus operator workflow docs; ensure defaults map exactly to engine config values."
    },
    {
      "id": "GOV-782",
      "wbs_ref": "6.7",
      "area_id": "76-0",
      "title": "Gemini lifecycle parity update",
      "scope": "Update GEMINI.md guidance to mirror CLAUDE/Codex lifecycle capabilities including preflight, heartbeat, review, template, and ontology governance commands."
    },
    {
      "id": "GOV-783",
      "wbs_ref": "6.8",
      "area_id": "76-0",
      "title": "Gap-closure integration validation",
      "scope": "Run end-to-end validation for the new hardening packets, capture residual risks, and publish a concise closure report covering test evidence and documentation alignment."
    },
    {
      "id": "GOV-784",
      "wbs_ref": "7.1",
      "area_id": "77-0",
      "title": "PRD v2 delta contract and scope freeze",
      "scope": "Publish implementation contract that distinguishes already-delivered Enhancements 1-6 from v2 delta work, codifies non-goals, and resolves compatibility wording (multi-user is code + deployment change)."
    },
    {
      "id": "GOV-785",
      "wbs_ref": "7.2",
      "area_id": "77-0",
      "title": "DCL canonical JSON specification",
      "scope": "Implement canonical serialization module with strict rules (sorted keys, separators, UTF-8, NaN/Infinity rejection, datetime normalization contract) and developer-facing spec docs."
    },
    {
      "id": "GOV-786",
      "wbs_ref": "7.3",
      "area_id": "77-0",
      "title": "Canonicalization conformance vectors",
      "scope": "Add golden test corpus for canonical serialization across edge cases (int/float distinctions, unicode normalization expectations, null handling, arrays, prohibited numbers) and CI enforcement."
    },
    {
      "id": "GOV-787",
      "wbs_ref": "7.4",
      "area_id": "77-0",
      "title": "DCL commit object + hash pipeline",
      "scope": "Implement commit object model (action_hash, pre/post state hash, constitution_hash, mandatory diff, seq linkage, genesis rules) and commit hashing pipeline in governance engine."
    },
    {
      "id": "GOV-788",
      "wbs_ref": "7.5",
      "area_id": "77-0",
      "title": "File-mode transactional journal for DCL",
      "scope": "Implement crash-safe file-mode transaction protocol (journal/write-intent, fsync, atomic swap, replay recovery) so commit/state updates are atomic in OSS mode."
    },
    {
      "id": "GOV-789",
      "wbs_ref": "7.6",
      "area_id": "77-0",
      "title": "DCL verifier and proof export",
      "scope": "Implement per-packet replay verifier, verify --all, history viewer, and proof bundle export with precise tamper failure localization."
    },
    {
      "id": "GOV-790",
      "wbs_ref": "7.7",
      "area_id": "77-0",
      "title": "Project checkpoints and Merkle root chain",
      "scope": "Implement project-level checkpoint commits with Merkle root over packet heads to detect missing packet histories and add phase-closeout checkpoint command."
    },
    {
      "id": "GOV-791",
      "wbs_ref": "7.8",
      "area_id": "77-0",
      "title": "Lifecycle integration with DCL policies",
      "scope": "Integrate DCL emission policy across operations (including heartbeat batching policy and transition-triggered heartbeat commits) without regressing existing lifecycle behavior."
    },
    {
      "id": "GOV-792",
      "wbs_ref": "7.9",
      "area_id": "77-0",
      "title": "API boundary and CLI transport abstraction",
      "scope": "Introduce API server boundary for governance mutations and refactor CLI to support local-file mode and API-client mode with command parity."
    },
    {
      "id": "GOV-793",
      "wbs_ref": "7.10",
      "area_id": "77-0",
      "title": "Database state manager (SQLite/Postgres)",
      "scope": "Implement database-backed StateManager with transaction semantics, schema migration path from file-state, and parity with existing GovernanceEngine behavior."
    },
    {
      "id": "GOV-794",
      "wbs_ref": "7.11",
      "area_id": "77-0",
      "title": "RBAC and authenticated identity model",
      "scope": "Define and implement operator/reviewer/supervisor/admin role model, authenticated identities, reviewer uniqueness semantics, and service-account constraints for automation."
    },
    {
      "id": "GOV-795",
      "wbs_ref": "7.12",
      "area_id": "77-0",
      "title": "Git audit ledger integration service",
      "scope": "Implement server-side Git ledger writer for DCL commits and governance events with replay-reconstruct support and integrity verification hooks."
    },
    {
      "id": "GOV-796",
      "wbs_ref": "7.13",
      "area_id": "77-0",
      "title": "Web parity for governance operations",
      "scope": "Extend Next.js control-plane UI to parity for preflight/review/ontology/template/DCL integrity views and multi-user session-aware operations."
    },
    {
      "id": "GOV-797",
      "wbs_ref": "7.14",
      "area_id": "77-0",
      "title": "Drift maturity separation and semantics roadmap",
      "scope": "Implement explicit drift mode levels (coverage heuristic, token heuristic, semantic contradiction future) in code/docs/CLI output to avoid overclaiming current capability."
    },
    {
      "id": "GOV-798",
      "wbs_ref": "7.15",
      "area_id": "77-0",
      "title": "Program integration and rollout validation",
      "scope": "Run end-to-end validation for DCL + multi-user foundations, verify backward compatibility for single-user OSS mode, and publish rollout report with residual risks."
    },
    {
      "id": "GOV-799",
      "wbs_ref": "7.16",
      "area_id": "77-0",
      "title": "License migration to AGPL-3.0",
      "scope": "Replace MIT licensing with AGPL-3.0 across LICENSE and repository governance/docs references; ensure badges and policy text align with copyleft distribution obligations."
    }
  ],
  "dependencies": {
    "UX-702": [
      "UX-701"
    ],
    "RF-732": [
      "RF-731"
    ],
    "RF-733": [
      "RF-732"
    ],
    "RF-734": [
      "RF-731"
    ],
    "RF-735": [
      "RF-731"
    ],
    "RF-736": [
      "RF-732",
      "RF-733",
      "RF-734",
      "RF-735"
    ],
    "SHIP-742": [
      "SHIP-741"
    ],
    "SHIP-743": [
      "SHIP-742"
    ],
    "SHIP-744": [
      "SHIP-741"
    ],
    "SHIP-745": [
      "SHIP-741"
    ],
    "SHIP-746": [
      "SHIP-742",
      "SHIP-743",
      "SHIP-744",
      "SHIP-745"
    ],
    "GOV-752": [
      "GOV-751"
    ],
    "GOV-753": [
      "GOV-751"
    ],
    "GOV-754": [
      "GOV-752"
    ],
    "GOV-755": [
      "GOV-754"
    ],
    "GOV-756": [
      "GOV-755"
    ],
    "GOV-757": [
      "GOV-752"
    ],
    "GOV-758": [
      "GOV-757"
    ],
    "GOV-759": [
      "GOV-758"
    ],
    "GOV-760": [
      "GOV-752"
    ],
    "GOV-761": [
      "GOV-760"
    ],
    "GOV-762": [
      "GOV-756",
      "GOV-759",
      "GOV-761"
    ],
    "GOV-763": [
      "GOV-762"
    ],
    "GOV-764": [
      "GOV-763"
    ],
    "GOV-765": [
      "GOV-764"
    ],
    "GOV-766": [
      "GOV-763"
    ],
    "GOV-767": [
      "GOV-766"
    ],
    "GOV-768": [
      "GOV-765",
      "GOV-767"
    ],
    "GOV-769": [
      "GOV-768"
    ],
    "GOV-770": [
      "GOV-769"
    ],
    "GOV-771": [
      "GOV-770"
    ],
    "GOV-772": [
      "GOV-771"
    ],
    "GOV-773": [
      "GOV-772"
    ],
    "GOV-774": [
      "GOV-773"
    ],
    "GOV-775": [
      "GOV-774",
      "GOV-753"
    ],
    "GOV-777": [
      "GOV-776"
    ],
    "GOV-778": [
      "GOV-776"
    ],
    "GOV-779": [
      "GOV-778"
    ],
    "GOV-780": [
      "GOV-779"
    ],
    "GOV-781": [
      "GOV-779"
    ],
    "GOV-782": [
      "GOV-779"
    ],
    "GOV-783": [
      "GOV-777",
      "GOV-780",
      "GOV-781",
      "GOV-782"
    ],
    "GOV-785": [
      "GOV-784"
    ],
    "GOV-786": [
      "GOV-785"
    ],
    "GOV-787": [
      "GOV-785",
      "GOV-786"
    ],
    "GOV-788": [
      "GOV-787"
    ],
    "GOV-789": [
      "GOV-787",
      "GOV-788"
    ],
    "GOV-790": [
      "GOV-789"
    ],
    "GOV-791": [
      "GOV-787",
      "GOV-789"
    ],
    "GOV-792": [
      "GOV-784"
    ],
    "GOV-793": [
      "GOV-792"
    ],
    "GOV-794": [
      "GOV-792",
      "GOV-793"
    ],
    "GOV-795": [
      "GOV-787",
      "GOV-792",
      "GOV-793"
    ],
    "GOV-796": [
      "GOV-791",
      "GOV-794",
      "GOV-795"
    ],
    "GOV-797": [
      "GOV-784",
      "GOV-791"
    ],
    "GOV-798": [
      "GOV-790",
      "GOV-793",
      "GOV-794",
      "GOV-795",
      "GOV-796",
      "GOV-797"
    ],
    "GOV-799": [
      "GOV-798"
    ]
  }
}
